<%- include('./partials/header') %>
  <%- include('./partials/userHeader') %>
    <div class="axil-checkout-area">
      <!-- Start Shop Area  -->
      <div class="axil-single-product-area bg-color-white">
        <div class="single-product-thumb axil-section-gap pb--20 pb_sm--0 bg-vista-white">

          <div class="container">
            <div class="row row--25 align-items-start">
              <!-- üñºÔ∏è Image Slider - LEFT (Desktop) -->
              <div class="col-lg-5 mb--40">
                <div class="position-sticky sticky-top">
                  <div class="product-image-slider mb-4">

                    <!-- üñºÔ∏è Image Slider -->
                    <% if (product.images && product.images.length> 0) { %>
                      <% product.images.forEach(image=> { %>
                        <div style="display: flex; justify-content: center; align-items: center;">

                          <img class="img-fluid object-cover" src="<%= image %>" alt="<%= product.name %>"
                            style="border-radius: 10px; height: 400px; width: 300px; " />
                        </div>
                        <% }) %>
                          <% } else { %>
                            <div>
                              <img class="img-fluid w-100" src="/assets/images/placeholder.jpg" alt="No Image Available"
                                style="border-radius: 10px;" />
                            </div>
                            <% } %>

                  </div>
                </div>
              </div>

              <!-- üìù Product Info - RIGHT (Desktop) -->
              <div class="col-lg-7 mb--40">
                <div class="single-product-content">
                  <div class="inner">
                    <h2 class="product-title">
                      <%= product.name %>
                    </h2>
                    <span class="price-amount"><span style="text-decoration: line-through; color: grey">‚Çπ<%=
                          product.price %></span>&nbsp;‚Çπ<%= product.discount %></span>
                   <!-- ‚≠ê Overall Rating Display (Place this here) -->
    
    <div class="row mb-4">
                   <div class="product-action-wrapper col-lg-8 col-md-12 col-sm-12 mb-3">
  <div class="d-flex align-items-center gap-3 flex-wrap flex-lg-nowrap" style="flex-wrap: nowrap;">
    
    <!-- üì¶ Quantity Selector -->
    <div class="d-flex align-items-center border rounded-pill px-3 py-1 bg-light"
      style="height: 44px; white-space: nowrap;">
      <button class="btn btn-sm px-2 py-0 border-0 bg-transparent" onclick="adjustQty(-1)">
        <i class="fas fa-minus"></i>
      </button>
      <span id="qty-value" class="mx-3 fw-bold"
        style="min-width: 20px; text-align: center; font-size: 16px; color: #000;">1</span>
      <button class="btn btn-sm px-2 py-0 border-0 bg-transparent" onclick="adjustQty(1)">
        <i class="fas fa-plus"></i>
      </button>
    </div>

<!-- üõçÔ∏è Buy Now -->
<button
  type="button"
  class="btn btn-danger fw-semibold px-4 py-2 rounded-pill"
  style="height: 44px; width: 25%;"
  onclick="buyNow('<%= product._id %>', '<%= product.name %>', <%= product.discount || product.price %>)"
  <%= !product.isAvailable ? 'disabled' : '' %>>
  Buy Now
</button>

    <!-- ‚ù§Ô∏è Wishlist -->
    <button
      class="add-to-wishlist btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center"
      style="width: 55px; height: 44px;" data-id="<%=product._id %>">
      <i class="fas fa-heart fa-lg text-danger"></i>
    </button>

    <!-- üõí Add to Cart -->
    <button data-id="<%= product._id %>"
      class="add-to-cart btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center"
      style="width: 55px; height: 44px;">
      <i class="fas fa-cart-plus fa-lg"></i>
    </button>

<!-- üì§ Share -->
<div class="dropdown d-inline-block">
  <button
    class="btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center"
    style="width: 55px; height: 44px;"
    id="shareDropdownBtn"
    data-bs-toggle="dropdown" aria-expanded="false">
    <i class="fas fa-share-alt fa-lg"></i>
  </button>

  <div class="dropdown-menu p-2" aria-labelledby="shareDropdownBtn" style="min-width: 260px;">
    <div class="d-flex align-items-center gap-2">
      <!-- WhatsApp -->
<a class="share-pill"
   href="https://wa.me/?text=<%= encodedShareText %>"
   target="_blank"
   title="WhatsApp">
  <i class="fab fa-whatsapp"></i>
</a>

      <!-- Instagram (no web share API) -> copy link + open IG -->
      <button type="button" class="share-pill" onclick="shareToInstagram('<%= fullUrl %>')" title="Instagram">
        <i class="fab fa-instagram"></i>
      </button>

      <!-- Facebook -->
      <a class="share-pill" href="https://www.facebook.com/sharer/sharer.php?u=<%= encodeURIComponent(fullUrl) %>"
         target="_blank" title="Facebook">
        <i class="fab fa-facebook-f"></i>
      </a>

      <!-- Twitter / X -->
      <a class="share-pill"
         href="https://twitter.com/intent/tweet?text=<%= encodeURIComponent(product.name) %>&url=<%= encodeURIComponent(fullUrl) %>"
         target="_blank" title="Twitter">
        <i class="fab fa-twitter"></i>
      </a>

      <!-- Copy Link -->
      <button type="button" class="share-pill" onclick="copyLink('<%= fullUrl %>')" title="Copy link">
        <i class="fas fa-link"></i>
      </button>
    </div>
  </div>
</div>


  </div>
</div>

<div class="col-lg-4 col-md-12 col-sm-12">
  <ul class="product-meta mb-3">
<% if (product.isAvailable) { %>
<li class="text-success"><i class="fal fa-check"></i> In stock</li>
<% } else { %>
<li class="text-danger"><i class="fal fa-times"></i> Out of stock</li>
<% } %>
<li><i class="fal fa-check"></i> Free delivery available</li>
</ul>
</div>
    </div>

                    <p class="description mb-4">
                      <%= product.description %>
                    </p>

                    <h6>Product Details</h6>
                    <ul class="list-unstyled">
                      <li><span>Length: </span>
                        <%= product.length %>
                      </li>
                    <% if (product.blouseDetails && product.blouseDetails.toLowerCase() !== "nil") { %>
  <li>
    <span>Blouse Details: </span>
    <%= product.blouseDetails %>
  </li>
<% } %>


                    <li><span>Fabric: </span>
                        <%= product.fabric %>
                      </li>

                   <% if (product.design && product.design.toLowerCase() !== "nil") { %>
  <li>
    <span>Design: </span>
    <%= product.design %>
  </li>
<% } %>


                      <li><span>Colour: </span>
                        <%= product.colour %>
                      </li>
                    </ul>

<form id="buyNowForm" action="/checkout" method="POST">
  <input type="hidden" name="cartData" id="productCartDataInput" />
</form>


                    <!-- üì¢ Customer Reviews -->
                    <!-- Review Form -->
                   <!-- ‚≠ê Submit Review Form -->
<form id="reviewForm" action="/product/<%= product._id %>/review" method="POST" enctype="multipart/form-data" onsubmit="return validateReviewForm()">
  <div class="form-group mt-5">
    <div class="row">
      <div class="rating-container col-6">
        <p>Rate Your Product:</p>
        <div id="overallRating-stars">
          <% for(let i = 1; i <= 5; i++) { %>
            <span class="star" onclick="setRating('overallRating', <%= i %>)">‚òÖ</span>
          <% } %>
        </div>
        <input type="hidden" id="overallRating" name="rating" required />
      </div>
      <div class="toggle-bar col-6">
        <a href="javascript:void(0)" class="toggle-btn-write">Write a Review..?</a>
      </div>
    </div>

    <div class="toggle-open-write">
      <div class="form-group mt-4">
        <p>Your Review</p>
        <textarea id="review" name="comment" class="form-control" rows="4" placeholder="Write your experience..."  required></textarea>
      </div>

      <div class="form-group">
        <p>Upload Images</p>
        <input type="file" name="images" class="form-control" multiple />
      </div>

      <ul class="list-inline mt-4">
        <li class="list-inline-item">
          <button type="submit" class="btn btn-success">Submit</button>
        </li>
        <li class="list-inline-item">
          <button type="reset" class="btn btn-danger">Cancel</button>
        </li>
      </ul>
    </div>
  </div>
</form>

                   <div class="form-group  mt-5">
                        <div class="row">
                          <div class="rating-container col-6">
                            <p>Overall Rating:</p>
                            <div class="d-flex">
  <% for (let i = 1; i <= 5; i++) { %>
    <i class="fa-star <%= i <= Math.round(avgRating) ? 'fas text-warning' : 'far text-muted' %>"></i>
  <% } %>
</div>

                            <!-- <div id="overallRating-stars">
                              <span class="star" onclick="setRating('overallRating', 1)">‚òÖ</span>
                              <span class="star" onclick="setRating('overallRating', 2)">‚òÖ</span>
                              <span class="star" onclick="setRating('overallRating', 3)">‚òÖ</span>
                              <span class="star" onclick="setRating('overallRating', 4)">‚òÖ</span>
                              <span class="star" onclick="setRating('overallRating', 5)">‚òÖ</span>
                            </div> -->
                            <input type="hidden" id="overallRating" name="overallRating" required />
                          </div>

                          <div class="toggle-bar col-6">
                            <a href="javascript:void(0)" class="toggle-btn-view">
                              View Reviews..!
                            </a>
                          </div>

                        </div>

                        <div class="toggle-open-view">

                          <!-- ‚≠ê View Reviews -->
<div class="form-group">
  <h4>Customer Reviews</h4>
  <% if (reviews && reviews.length > 0) { %>
  <% reviews.forEach(review => { %>
    <div class="border p-3 mb-3 rounded shadow-sm bg-light">
      <strong>‚≠ê <%= review.rating %>/5</strong>
      <p class="mb-1"><%= review.review %></p>
      <% if (review.images && review.images.length > 0) { %>
        <div class="d-flex gap-2 flex-wrap mt-2">
          <% review.images.forEach(img => { %>
            <img src="<%= img %>" alt="Review Image" style="height: 80px; width: auto; border-radius: 5px;" />
          <% }) %>
        </div>
      <% } %>

      <% if(user) { %>
      <% if (String(review.userId) === String(user._id)) { %>
      <div class="mt-2 d-flex gap-2">
      
        <!-- Edit Button -->
<button 
  class="btn btn-sm btn-warning edit-review-btn"
  data-id="<%= review._id %>"
  data-rating="<%= review.rating %>"
  data-comment="<%= review.review %>"
  data-images="<%= review.images ? review.images.join(',') : '' %>"
>
  Edit
</button>

        
        <!-- Delete Button -->
          <button 
  class="btn btn-sm btn-danger delete-review" 
  data-product-id="<%= product._id %>" 
  data-review-id="<%= review._id %>"
>
  Delete
</button>
      </div>
    <% } %>
  <% } %>

    </div>
  <% }) %>
<% } else { %>
  <p>No reviews yet. Be the first to review!</p>
<% } %>

</div>
                        </div>
                      </div>
                   <style>
  .rating-container {
    align-items: center;
    gap: 10px;
  }

  .rating-container p {
    margin: 0;
    font-weight: 500;
  }

  #overallRating-stars .star {
    font-size: 20px;
    color: #ccc;
    cursor: pointer;
    margin-left: 0px;
  }

  #overallRating-stars .star.selected {
    color: gold;
  }

  .toggle-open {
    display: none;
  }

  .toggle-open.show {
    display: block;
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>


<style>
  .toggle-open-write,
  .toggle-open-view {
    display: none;
  }

  .toggle-open-write.show,
  .toggle-open-view.show {
    display: block;
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .rating-container {
    align-items: center;
    gap: 10px;
  }

  .rating-container p {
    margin: 0;
    font-weight: 500;
  }

  #overallRating-stars .star {
    font-size: 20px;
    color: #ccc;
    cursor: pointer;
    margin-left: 5px;
  }

  #overallRating-stars .star.selected {
    color: gold;
  }
</style>

                </div>
              </div>
            </div>
          </div>

          <!-- End Shop Area  -->
  <% if (recentlyViewedProducts && recentlyViewedProducts.length > 0) { %>
  <div class="axil-new-arrivals-product-area fullwidth-container flash-sale-area section-gap-80-35">
    <div class="container ml--xxl-0">
      <div class="section-title-border slider-section-title">
        <h2 class="title">Recently Viewed üí•</h2>
      </div>
      <div class="recently-viwed-activation slick-layout-wrapper--15 axil-slick-angle angle-top-slide">
        <% recentlyViewedProducts.forEach(product => { %>
          <div class="slick-single-layout">
            <div class="axil-product product-style-eight">
              <div class="thumbnail">
                <a href="/product?id=<%= product._id %>">
                  <% if (product.images && product.images.length > 0) { %>
                    <img class="main-img" src="<%= product.images[0] %>" alt="<%= product.name || 'Product' %>">
                  <% } else { %>
                    <img class="main-img" src="/images/placeholder.png" alt="No image available">
                  <% } %>
                </a>
                <% if (product.discount > 0) { %>
                  <div class="label-block label-left">
                    <div class="product-badget sale">Sale</div>
                  </div>
                <% } %>
                <!-- <div class="product-hover-action">
                  <ul class="cart-action">
                    <li class="select-option">
                      <a href="/product/<%= product._id %>">
                        <i class="fas fa-shopping-cart"></i> Add to Cart
                      </a>
                    </li>
                  </ul>
                </div> -->
              </div>
              <div class="product-content">
                <div class="inner">
                  <h5 class="title">
                    <a href="/product/<%= product._id %>"><%= product.name || 'Untitled' %></a>
                  </h5>
                  <div class="product-price-variant">
                   
                      <span class="price current-price">‚Çπ<%= product.discount %></span>
                   
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    </div>
  </div>
<% } else { %>
  <div class="container text-center py-5">
    <h4>No recently viewed products üòî</h4>
  </div>
<% } %>

          </div>

<!-- Edit Review Modal -->
<div class="modal fade" id="editReviewModal" tabindex="-1">
  <div class="modal-dialog">
    <form id="editReviewForm" enctype="multipart/form-data">
      <input type="hidden" id="editReviewId" name="reviewId">

      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Review</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <label>Rating</label>
          <div id="editRatingStars" class="mb-2">
            <% for(let i=1; i<=5; i++) { %>
              <span class="star" data-value="<%= i %>">‚òÖ</span>
            <% } %>
          </div>
          <input type="hidden" id="editRating" name="rating">

          <label>Review</label>
          <textarea id="editComment" name="comment" class="form-control"></textarea>

          <label class="mt-3">Current Images</label>
          <div id="currentImages" class="d-flex gap-2 flex-wrap"></div>

          <label class="mt-3">Upload New Images</label>
          <input type="file" id="editImages" name="images" class="form-control" multiple>
          <div id="newImagePreview" class="d-flex gap-2 flex-wrap mt-2"></div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Update Review</button>
        </div>
      </div>
    </form>
  </div>
</div>

<style>
  #editRatingStars .star {
    font-size: 22px;
    cursor: pointer;
    color: #ccc;
  }
  #editRatingStars .star.selected {
    color: gold;
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // ‚≠ê Open modal with data
  document.querySelectorAll(".edit-review-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const id = btn.dataset.id;
      const rating = btn.dataset.rating;
      const comment = btn.dataset.comment;
      const images = btn.dataset.images ? btn.dataset.images.split(",") : [];

      document.getElementById("editReviewId").value = id;
      document.getElementById("editComment").value = comment;

      // Set star rating
      setEditStars(rating);

      // Show existing images
      const currentImagesDiv = document.getElementById("currentImages");
      currentImagesDiv.innerHTML = "";
      images.forEach(img => {
        const imgEl = document.createElement("img");
        imgEl.src = img.trim();
        imgEl.style.height = "60px";
        imgEl.style.borderRadius = "5px";
        currentImagesDiv.appendChild(imgEl);
      });

      // Reset new image preview
      document.getElementById("newImagePreview").innerHTML = "";

      // Show modal
      const modal = new bootstrap.Modal(document.getElementById("editReviewModal"));
      modal.show();
    });
  });

  // ‚≠ê Handle star selection in modal
  document.querySelectorAll("#editRatingStars .star").forEach(star => {
    star.addEventListener("click", () => {
      const value = parseInt(star.dataset.value);
      setEditStars(value);
    });
  });

  function setEditStars(value) {
    document.getElementById("editRating").value = value;
    document.querySelectorAll("#editRatingStars .star").forEach((s, index) => {
      s.classList.toggle("selected", index < value);
    });
  }

  // üì∑ Preview newly uploaded images
  document.getElementById("editImages").addEventListener("change", function() {
    const previewDiv = document.getElementById("newImagePreview");
    previewDiv.innerHTML = "";
    Array.from(this.files).forEach(file => {
      const reader = new FileReader();
      reader.onload = e => {
        const img = document.createElement("img");
        img.src = e.target.result;
        img.style.height = "60px";
        img.style.borderRadius = "5px";
        previewDiv.appendChild(img);
      };
      reader.readAsDataURL(file);
    });
  });

  // üì§ Submit updated review via fetch
  document.getElementById("editReviewForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const reviewId = document.getElementById("editReviewId").value;
    const rating = document.getElementById("editRating").value;
    const comment = document.getElementById("editComment").value;
    const images = document.getElementById("editImages").files;

    const formData = new FormData();
    formData.append("rating", rating);
    formData.append("comment", comment);
    Array.from(images).forEach(file => formData.append("images", file));

    const productId = "<%= product._id %>"; // From EJS

    try {
      const res = await fetch(`/product/${productId}/review/${reviewId}`, {
        method: "PUT", // Assuming you use PUT for update
        body: formData
      });

      const data = await res.json();
      if (data.success) {
        Swal.fire({
          icon: "success",
          title: "Updated!",
          text: "Your review has been updated.",
          timer: 2000,
          showConfirmButton: false
        }).then(() => location.reload());
      } else {
        Swal.fire("Error", data.message || "Failed to update review.", "error");
      }
    } catch (err) {
      console.error(err);
      Swal.fire("Error", "Something went wrong while updating review.", "error");
    }
  });
});
</script>

<!-- <script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".delete-review").forEach(button => {
    button.addEventListener("click", async () => {
      const productId = button.dataset.productId;
      const reviewId = button.dataset.reviewId;

      if (!confirm("Are you sure you want to delete this review?")) return;

      try {
        const response = await fetch(`/product/${productId}/review/${reviewId}/delete`, {
          method: "DELETE",
          headers: { "Content-Type": "application/json" }
        });

        const result = await response.json();
        if (result.success) {
          alert("Review deleted successfully!");
          location.reload(); // refresh the page
        } else {
          alert(result.message || "Error deleting review");
        }
      } catch (err) {
        console.error(err);
        alert("Something went wrong!");
      }
    });
  });
});
</script> -->

<script>
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll(".delete-review").forEach((btn) => {
    btn.addEventListener("click", function () {
      const productId = btn.dataset.productId;
      const reviewId = btn.dataset.reviewId;

      Swal.fire({
        title: 'Are you sure?',
        text: "This will permanently delete the review!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Yes, delete it!',
        cancelButtonText: 'Cancel'
      }).then((result) => {
        if (result.isConfirmed) {
          fetch(`/product/${productId}/review/${reviewId}/delete`, {
            method: "DELETE"
          })
          .then((res) => res.json())
          .then((data) => {
            if (data.success) {
              Swal.fire('Deleted!', data.message, 'success').then(() => {
                location.reload();
              });
            } else {
              Swal.fire('Error!', data.message, 'error');
            }
          })
          .catch(() => {
            Swal.fire('Error!', 'Something went wrong.', 'error');
          });
        }
      });
    });
  });
});
</script>

   <script>
  $('.recently-viwed-activation').slick({
    infinite: false,
    slidesToShow: 4,
    slidesToScroll: 1,
    arrows: true,
    responsive: [
      {
        breakpoint: 992,
        settings: { slidesToShow: 2 }
      },
      {
        breakpoint: 768,
        settings: { slidesToShow: 1 }
      }
    ]
  });
</script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

    <script>
      $(document).ready(function () {
        $('.product-image-slider').slick({
          slidesToShow: 1,
          slidesToScroll: 1,
          arrows: true,
          dots: true,
          autoplay: true,
          autoplaySpeed: 3000,
          adaptiveHeight: true
        });
      });

    </script>

    <script>
      function adjustQty(change) {
        const qtySpan = document.getElementById("qty-value");
        let currentQty = parseInt(qtySpan.innerText);
        if (!isNaN(currentQty)) {
          const newQty = Math.max(1, currentQty + change);
          qtySpan.innerText = newQty;
        }
      }
    </script>

    <script>
      // ‚≠ê Toggle review form
      document.querySelector(".toggle-btn").addEventListener("click", function () {
        document.querySelector(".toggle-open").classList.toggle("show");
      });

      // ‚≠ê Star rating selection
      function setRating(fieldId, rating) {
        const starContainer = document.getElementById(fieldId + "-stars");
        const stars = starContainer.querySelectorAll(".star");

        stars.forEach((star, index) => {
          if (index < rating) {
            star.classList.add("selected");
          } else {
            star.classList.remove("selected");
          }
        });

        document.getElementById(fieldId).value = rating;
      }
    </script>

<script>
  // ‚≠ê Toggle "Write a Review"
  document.querySelector(".toggle-btn-write").addEventListener("click", function () {
    document.querySelector(".toggle-open-write").classList.toggle("show");
  });

  // ‚≠ê Toggle "View Reviews"
  document.querySelector(".toggle-btn-view").addEventListener("click", function () {
    document.querySelector(".toggle-open-view").classList.toggle("show");
  });

  // ‚≠ê Star rating selection
  function setRating(fieldId, rating) {
    const starContainer = document.getElementById(fieldId + "-stars");
    const stars = starContainer.querySelectorAll(".star");

    stars.forEach((star, index) => {
      if (index < rating) {
        star.classList.add("selected");
      } else {
        star.classList.remove("selected");
      }
    });

    document.getElementById(fieldId).value = rating;
  }
</script>

<script>
  function buyNow(productId, name, price) {
    const qty = parseInt(document.getElementById("qty-value").innerText) || 1;
    const subtotal = (price * qty).toFixed(2);

    const cartSummary = {
      items: [
        {
          productId,
          name,
          quantity: qty,
          price: price,
          subtotal: subtotal
        }
      ],
      total: subtotal
    };

    const cartDataInput = document.getElementById("productCartDataInput");
    cartDataInput.value = JSON.stringify(cartSummary);

    document.getElementById("buyNowForm").submit();
  }
</script>

<% if (reviewAdded) { %>
<script>
  Swal.fire({
    icon: 'success',
    title: 'Thank you!',
    text: 'Your review has been added successfully.',
    timer: 2000,
    showConfirmButton: false
  });
</script>
<% } %>

<script>
function validateReviewForm() {
  const ratingValue = document.getElementById("overallRating").value;
  
  if (!ratingValue || parseInt(ratingValue) < 1) {
    Swal.fire({
      icon: 'warning',
      title: 'Rating Required',
      text: 'Please select a rating before submitting your review.',
      confirmButtonColor: '#d33'
    });
    return false; // stop form submission
  }
  
  return true; // allow form submission
}
</script>

<style>
  .share-pill {
    width: 42px; height: 42px;
    border-radius: 9999px;
    border: 1px solid #e5e7eb;
    background: #fff;
    display: inline-flex;
    align-items: center; justify-content: center;
    cursor: pointer;
  }
  .share-pill i { font-size: 18px; }
  .share-pill .fa-whatsapp { color: #25D366; }
  .share-pill .fa-instagram { color: #E1306C; }
  .share-pill .fa-facebook-f { color: #1877F2; }
  .share-pill .fa-twitter { color: #1DA1F2; }
</style>

<script>
  function copyLink(link) {
    navigator.clipboard.writeText(link).then(() => {
      Swal.fire({
        icon: 'success',
        title: 'Link copied',
        text: 'URL copied to clipboard.',
        timer: 1600,
        showConfirmButton: false
      });
    });
  }

  // Instagram has no public web share URL. Best UX: copy link then open IG.
  function shareToInstagram(link) {
    navigator.clipboard.writeText(link).then(() => {
      Swal.fire({
        icon: 'info',
        title: 'Link copied',
        text: 'Open Instagram and paste the link in your post/story.',
        timer: 1800,
        showConfirmButton: false
      });
      // Open Instagram site/app (site on desktop; app if OS handles the scheme)
      setTimeout(() => {
        window.open('https://www.instagram.com/', '_blank');
      }, 300);
    });
  }
</script>

    <%- include('./partials/footer') %>
      </div>                  