<%- include('./partials/header') %>
<%- include('./partials/userHeader') %>

<!-- âœ… AOS CSS (place after your existing CSS link) -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet" />

<div class="main-wrapper">
  <div class="axil-shop-area axil-section-gap bg-color-white">
    <div class="container">
      <!-- Filters -->
      <div class="row align-items-end mb-4">
        <div class="col-lg-9 mb-3 mb-lg-0">
          <label for="categorySelect" class="form-label fw-semibold" style="font-size: 1.4rem; color: #333;">
            ðŸ§µ Choose Category
          </label>
            <select id="categorySelect" class="form-select shadow-sm" onchange="handleCategoryChange(this.value)" style="border-radius: 10px; padding: 14px 18px; font-size: 1.2rem;">
    <option value="">All Categories</option>
    <% categories.forEach(category => { %>
      <option value="<%= category.name %>"><%= category.name %></option>
    <% }) %>
  </select>
        </div>

        <div class="col-lg-3">
          <label for="priceSelect" class="form-label fw-semibold" style="font-size: 1.4rem; color: #333;">
            ðŸ’° Price Range
          </label>
          <select id="priceSelect" class="form-select shadow-sm" onchange="handlePriceFilter(this.value)" style="border-radius: 10px;  font-size: 1.2rem;">
            <option value="">All Prices</option>
            <option value="0 - 100">â‚¹0 - â‚¹100</option>
            <option value="100 - 500">â‚¹100 - â‚¹500</option>
            <option value="500 - 1000">â‚¹500 - â‚¹1000</option>
            <option value="1000 - 1500">â‚¹1000 - â‚¹1500</option>
          </select>
        </div>
      </div>

      <!-- Product Grid -->
      <div class="row gy-4" id="productGrid">
        <!-- Products will be rendered here -->
      </div>
    </div>
  </div>
</div>

<script>
  const allProducts = [
    { id: 1, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees1.jpg", price: 399, oldPrice: 499, discount: "20% OFF" },
    { id: 2, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees2.jpg", price: 999, oldPrice: 1499 },
    { id: 3, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees3.jpg", price: 450, oldPrice: 600, discount: "25% OFF" },
    { id: 4, name: "Guys Bomber Jacket", image: "/assets/images/handlooms/sarees4.jpg", price: 700, oldPrice: 1000 },
    { id: 5, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees5.jpg", price: 380, oldPrice: 499 },
    { id: 6, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees7.jpg", price: 1500, oldPrice: 2000, discount: "5% OFF" },
    { id: 7, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees8.jpg", price: 600, oldPrice: 800 },
    { id: 8, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees9.jpg", price: 300, oldPrice: 390 },
    { id: 9, name: "Zone Headphone", image: "/assets/images/handlooms/sarees11.jpg", price: 45, oldPrice: 60, discount: "30% OFF" },
    { id: 10, name: "Kasavu Set Mundu", image: "/assets/images/handlooms/sarees12.jpg", price: 700, oldPrice: 1000 }
  ];

  let filtered = [...allProducts];

  function renderProducts(products) {
    const grid = document.getElementById('productGrid');
    grid.innerHTML = "";

    if (products.length === 0) {
      grid.innerHTML = `<div class="text-center"><p>No products in this range.</p></div>`;
      return;
    }

    products.forEach(product => {
//       const html = `
// <div class="col-12 col-sm-6 col-md-4 col-lg-3" data-aos="fade-up product-card" data-aos-duration="800">
//           <div class="axil-product product-style-one has-color-pick">
//             <div class="thumbnail position-relative" style="width: 100%; height: 460px; overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
//               <img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover;" />
//               ${product.discount ? `<div class="label-block label-right"><div class="product-badget">${product.discount}</div></div>` : ""}
//             </div>
//             <div class="product-content text-center mt-2">
//               <h5 class="title">${product.name}</h5>
//               <div class="product-price-variant">
//                 ${product.oldPrice ? `<span class="price old-price" style="text-decoration: line-through; margin-right: 8px; color: #888;">â‚¹${product.oldPrice}</span>` : ""}
//                 <span class="price current-price fw-bold" style="color: #000;">â‚¹${product.price}</span>
//               </div>
//               <a href="/product/${product.id}" class="axil-btn mt-2 btn btn-warning text-white fw-semibold">View Details</a>
//             </div>
//           </div>
//         </div>`;
const html = `
  <div class="col-12 col-sm-6 col-md-4 col-lg-3 product-card" data-aos="fade-up" data-aos-duration="800">
    <div class="axil-product product-style-one d-flex flex-column flex-sm-column flex-md-column flex-lg-column flex-xl-column small-screen-card" style="gap: 10px;">
      <div class="thumbnail flex-shrink-0" style="width: 100%; height: 250px; overflow: hidden; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
        <img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover;" />
        ${product.discount ? `<div class="label-block label-right"><div class="product-badget">${product.discount}</div></div>` : ""}
      </div>
      <div class="product-content text-center text-sm-start px-2">
        <h5 class="title">${product.name}</h5>
        <div class="product-price-variant mb-1">
          ${product.oldPrice ? `<span class="price old-price me-2" style="text-decoration: line-through; color: #888;">â‚¹${product.oldPrice}</span>` : ""}
          <span class="price current-price fw-bold" style="color: #000;">â‚¹${product.price}</span>
        </div>
        <a href="/product" class="axil-btn btn btn-warning text-white fw-semibold">View Details</a>
      </div>
    </div>
  </div>`;

      grid.innerHTML += html;
    });

    // Reinitialize AOS after DOM update
    AOS.init();
  }

  function handlePriceFilter(value) {
    let min = 0, max = Infinity;
    if (value === "0 - 100") [min, max] = [0, 100];
    else if (value === "100 - 500") [min, max] = [100, 500];
    else if (value === "500 - 1000") [min, max] = [500, 1000];
    else if (value === "1000 - 1500") [min, max] = [1000, 1500];
    filtered = allProducts.filter(p => p.price >= min && p.price <= max);
    renderProducts(filtered);
  }

  function handleCategoryChange(value) {
    if (value === "Saree") window.location.href = "/category/sarees";
    else if (value === "SetSaree") window.location.href = "/category/setsaree";
    else if (value === "SetMund") window.location.href = "/category/setmund";
    else if (value === "Dhoti") window.location.href = "/category/dhoti";
  }

  // Initial render
  renderProducts(filtered);
</script>

<!-- âœ… AOS Script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
  AOS.init({ duration: 800, once: true });
</script>


<script>
  function handleCategoryChange(category) {
    if (category) {
      window.location.href = `/shop?category=${encodeURIComponent(category)}`;
    } else {
      window.location.href = `/shop`;
    }
  }
</script>

<style>
@media (max-width: 479.98px) {
  .small-screen-card {
    flex-direction: row !important;
    align-items: center;
  }

  .small-screen-card .thumbnail {
    width: 45% !important;
    height: 120px !important;
  }

  .small-screen-card .product-content {
    flex: 1;
    padding-left: 10px;
    text-align: left !important;
  }

  .small-screen-card .title {
    font-size: 1rem;
    margin-bottom: 4px;
  }

  .small-screen-card .product-price-variant {
    font-size: 0.95rem;
  }

  .small-screen-card .axil-btn {
    font-size: 0.9rem;
    padding: 4px 8px;
  }

/* Responsive Select Box Fix *
/* Mobile adjustments */
/* @media (max-width: 767.98px) {
  .container,
  .row,
  .col-lg-9,
  .col-lg-3 {
    max-width: 100% !important;
    padding-left: 10px !important;
    padding-right: 10px !important;
    box-sizing: border-box;
  }

  select.form-select {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }

  
  html, body {
    overflow-x: hidden !important;
  }

  .main-wrapper {
    overflow-x: hidden;
  }
}
} */
}

</style>
<%- include('./partials/footer') %>

