<%- include('./partials/header') %>


<div class="wrapper">
  <%- include('./partials/adminHeader') %>
  <%- include('./partials/sidebar') %>

  
<div class="page-content">

               <!-- Start Container Fluid -->
               <div class="container-fluid">

    <div class="table-responsive shadow-sm">
      <table class="table table-bordered table-hover bg-white">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Order ID</th>
            <th>Product</th>
            <th>Customer</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Submitted</th>
            <th>Actions</th>
          </tr>
        </thead>

<tbody>       
<% returnRequests.forEach((request, index) => { %>
  <tr>
    <td><%= index + 1 %></td>
    <td><a href="/admin/order-details?id=<%= request.orderDetails._id %>">
      <%= request.orderDetails.orderId %></a></td>
    <td><%= request.productName %></td>
    <td><a href="/admin/user-details?id=<%=request.userId._id%>">
      <%= request.orderDetails.address.name %> <br />
      <small><%= request.orderDetails.address.phone %></small>
    </a>
      
    </td>
    <td><%= request.reason %></td>
    <td>
      <span class="badge 
        <% if (request.status === 'Pending') { %> bg-warning 
           <% } else if (request.status === 'Approved') { %> bg-success 
           <% } else if (request.status === 'Rejected') { %> bg-danger 
           <% } else { %> bg-secondary <% } %>">
        <%= request.status %>
      </span>
    </td>
    <td><%= request.createdAt.toDateString() %></td>
    <td>
      <form action="/admin/return-update/<%= request._id %>" method="POST" class="d-flex gap-2">
        <select name="status" class="form-select form-select-sm" required>
          <option value="" disabled selected>Change Status</option>
          <option value="Approved">Approve</option>
          <option value="Rejected">Reject</option>
        </select>
        <button class="btn btn-sm btn-primary">Update</button>
      </form>
    </td>
  </tr>
<% }) %>
        </tbody>
      </table>
    

    <p class="text-muted mt-3" style="font-size: 0.9rem;">Total Requests: <%= returnRequests.length %></p>
  </div>
  </div>
  </div>
  <%- include('./partials/footer') %>
</div>
